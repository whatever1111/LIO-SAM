<launch>
  <arg name="project" default="lio_sam"/>
  <arg name="params" default="$(find lio_sam)/config/params.yaml"/>
  <arg name="location_status_ok" default="1"/>
  <arg name="location_status_lost" default="0"/>

  <!-- Load base parameters -->
  <rosparam file="$(arg params)" command="load" />

  <!-- Override for typical navigation integration -->
  <param name="lio_sam/pointCloudTopic" value="/lidar_points" />
  <param name="lio_sam/imuTopic" value="/imu/data" />
  <param name="lio_sam/lidarFrame" value="lidar_link" />
  <param name="lio_sam/imuFrame" value="imu_link" />
  <param name="lio_sam/baselinkFrame" value="base_link" />

  <!-- Avoid conflicting with map_server's global frame 'map' -->
  <param name="lio_sam/mapFrame" value="lio_map" />
  <param name="lio_sam/odometryFrame" value="lio_odom" />

  <!-- In many robots, base_link->lidar_link is already published on /tf_static -->
  <param name="lio_sam/publishBaseToLidarTf" value="false" />
  <!-- Most robots do NOT publish imu_link; keep this enabled unless you already have lidar_link->imu_link in /tf_static -->
  <param name="lio_sam/publishLidarToImuTf" value="true" />
  <param name="lio_sam/publishBaseToGpsTf" value="false" />

  <!-- LIO-SAM core -->
  <include file="$(find lio_sam)/launch/include/module_loam.launch" />

  <!-- Bridge to legacy navigation interfaces -->
  <node pkg="$(arg project)" type="bridge_lio_sam_to_nav.py" name="lio_sam_nav_bridge" output="screen" respawn="true">
    <param name="map_frame" value="map" />
    <param name="lio_map_frame" value="lio_map" />
    <param name="base_frame" value="base_link" />
    <param name="odom_topic" value="/odom" />
    <param name="location_status_topic" value="/location_status" />
    <!-- Adjust these two to match your legacy /location_status semantics -->
    <param name="location_status_ok" value="$(arg location_status_ok)" />
    <param name="location_status_lost" value="$(arg location_status_lost)" />
  </node>
</launch>
